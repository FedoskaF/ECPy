
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>ecpy.curves &#8212; ECPy 0.8 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for ecpy.curves</h1><div class="highlight"><pre>
<span></span><span class="c1"># encoding: UTF-8</span>

<span class="c1"># Copyright 2016-2017 Cedric Mesnil &lt;cedric.mesnil@ubinity.com&gt;, Ubinity SAS</span>
<span class="c1">#</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#     http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>


<span class="sd">&quot;&quot;&quot; Elliptic Curve and Point manipulation</span>

<span class="sd">.. moduleauthor:: Cédric Mesnil &lt;cedric.mesnil@ubinity.com&gt;</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="c1">#python 2 compatibility</span>
<span class="kn">from</span> <span class="nn">builtins</span> <span class="k">import</span> <span class="nb">int</span><span class="p">,</span><span class="nb">pow</span>

<span class="kn">import</span> <span class="nn">binascii</span>
<span class="kn">import</span> <span class="nn">random</span>



<div class="viewcode-block" id="decode_scalar_25519"><a class="viewcode-back" href="../../index.html#ecpy.curves.decode_scalar_25519">[docs]</a><span class="k">def</span> <span class="nf">decode_scalar_25519</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; decode scalar according to RF7748 and draft-irtf-cfrg-eddsa</span>

<span class="sd">    Args:</span>
<span class="sd">           k (bytes) : scalar to decode</span>

<span class="sd">    Returns:</span>
<span class="sd">          int: decoded scalar</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">k</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="o">&amp;=</span> <span class="mh">0xF8</span>
    <span class="n">k</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span> <span class="o">&amp;</span><span class="mh">0x7F</span><span class="p">)</span> <span class="o">|</span> <span class="mh">0x40</span>
    <span class="n">k</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="s1">&#39;little&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">k</span></div>

<div class="viewcode-block" id="encode_scalar_25519"><a class="viewcode-back" href="../../index.html#ecpy.curves.encode_scalar_25519">[docs]</a><span class="k">def</span> <span class="nf">encode_scalar_25519</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; encode scalar according to RF7748 and draft-irtf-cfrg-eddsa</span>

<span class="sd">    Args:</span>
<span class="sd">           k (int) : scalar to encode</span>

<span class="sd">    Returns:</span>
<span class="sd">          bytes: encoded scalar</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">k</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span><span class="s1">&#39;little&#39;</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="o">&amp;=</span> <span class="mh">0xF8</span>
    <span class="n">k</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span> <span class="o">&amp;</span><span class="mh">0x7F</span><span class="p">)</span> <span class="o">|</span> <span class="mh">0x40</span>
    <span class="n">k</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">k</span></div>


<div class="viewcode-block" id="Curve"><a class="viewcode-back" href="../../index.html#ecpy.curves.Curve">[docs]</a><span class="k">class</span> <span class="nc">Curve</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Elliptic Curve abstraction</span>

<span class="sd">    You should not directly create such Object.</span>
<span class="sd">    Use `get_curve` to get the predefined curve or create a well-know type</span>
<span class="sd">    of curve with your parameters</span>

<span class="sd">    Supported well know elliptic curve are:</span>
<span class="sd">       - Short Weierstrass form:  y²=x³+a*x+b</span>
<span class="sd">       - Twisted Edward          a*x²+y2=1+d*x²*y²</span>

<span class="sd">    Attributes:</span>
<span class="sd">       name (str)       : curve name, the one given to get_curve or return by get_curve_names</span>
<span class="sd">       size (int)       : bit size of curve</span>
<span class="sd">       a (int)          : first curve parameter</span>
<span class="sd">       b d (int)        : second curve parameter</span>
<span class="sd">       field (int)      : curve field</span>
<span class="sd">       generator (Point): curve point generator</span>
<span class="sd">       order (int)      : order of generator</span>

<span class="sd">    &quot;&quot;&quot;</span>
    

<div class="viewcode-block" id="Curve.get_curve"><a class="viewcode-back" href="../../index.html#ecpy.curves.Curve.get_curve">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_curve</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a Curve object  according to its name</span>
<span class="sd">        </span>
<span class="sd">       Args:</span>
<span class="sd">           name (str) : curve name to retrieve</span>

<span class="sd">       Returns:</span>
<span class="sd">           Curve:          Curve object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">curves</span> <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">name</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">cp</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">cp</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">WEIERSTRASS</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">WeierstrassCurve</span><span class="p">(</span><span class="n">cp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cp</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">TWISTEDEDWARD</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">TwistedEdwardCurve</span><span class="p">(</span><span class="n">cp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cp</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">MONTGOMERY</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">MontgomeryCurve</span><span class="p">(</span><span class="n">cp</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="Curve.get_curve_names"><a class="viewcode-back" href="../../index.html#ecpy.curves.Curve.get_curve_names">[docs]</a>    <span class="nd">@staticmethod</span>    
    <span class="k">def</span> <span class="nf">get_curve_names</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot; Returns all known curve names</span>

<span class="sd">        Returns: </span>
<span class="sd">          tuple:  list of names as str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">curves</span><span class="p">]</span></div>
        
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parameters</span><span class="p">):</span>        
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Abstract method __init__&#39;</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">keys</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_domain</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_domain</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_domain</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_domain</span><span class="p">[</span><span class="s1">&#39;generator&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_domain</span><span class="p">[</span><span class="s1">&#39;generator&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_domain</span><span class="p">[</span><span class="s1">&#39;generator&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span>

        
    <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_domain</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_domain</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_domain</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Curve.is_on_curve"><a class="viewcode-back" href="../../index.html#ecpy.curves.Curve.is_on_curve">[docs]</a>    <span class="k">def</span> <span class="nf">is_on_curve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if P is on this curve </span>

<span class="sd">        This function ignores the default curve attach to P</span>
<span class="sd">    </span>
<span class="sd">        Args:</span>
<span class="sd">            P (Point): Point to check</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True if P is on curve, False else</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Abstract method is_on_curve&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Curve.add_point"><a class="viewcode-back" href="../../index.html#ecpy.curves.Curve.add_point">[docs]</a>    <span class="k">def</span> <span class="nf">add_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the sum of P and Q</span>

<span class="sd">        This function ignores the default curve attach to P and Q, </span>
<span class="sd">        and assumes P and Q are on this curve.</span>
<span class="sd">    </span>
<span class="sd">        Args:</span>
<span class="sd">            P (Point): first  point to add</span>
<span class="sd">            Q (Point): second point to add</span>

<span class="sd">        Returns:</span>
<span class="sd">            Point: A new Point R = P+Q</span>

<span class="sd">        Raises:</span>
<span class="sd">             ECPyException : with &quot;Point not on curve&quot;, if Point R is not on \</span>
<span class="sd">             curve,  thus meaning either P or Q was not on.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Abstract method add_point&#39;</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="Curve.sub_point"><a class="viewcode-back" href="../../index.html#ecpy.curves.Curve.sub_point">[docs]</a>    <span class="k">def</span> <span class="nf">sub_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the difference of P and Q</span>

<span class="sd">        This function ignores the default curve attach to P and Q, </span>
<span class="sd">        and assumes P and Q are on this curve.</span>
<span class="sd">    </span>
<span class="sd">        Args:</span>
<span class="sd">            P (Point): first  point to subtract with</span>
<span class="sd">            Q (Point): second point to subtract to</span>

<span class="sd">        Returns:</span>
<span class="sd">            Point: A new Point R = P-Q</span>

<span class="sd">        Raises:</span>
<span class="sd">             ECPyException : with &quot;Point not on curve&quot;, if Point R is not on \</span>
<span class="sd">             curve,  thus meaning either P or Q was not on.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_point</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="o">.</span><span class="n">neg</span><span class="p">())</span></div>

            
<div class="viewcode-block" id="Curve.mul_point"><a class="viewcode-back" href="../../index.html#ecpy.curves.Curve.mul_point">[docs]</a>    <span class="k">def</span> <span class="nf">mul_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the scalar multiplication  P with k.</span>

<span class="sd">        This function ignores the default curve attach to P and Q, </span>
<span class="sd">        and assumes P and Q are on this curve.</span>
<span class="sd">    </span>
<span class="sd">        Args:</span>
<span class="sd">            P (Point): point to mul_point</span>
<span class="sd">            k (int)  : scalar to multiply</span>

<span class="sd">        Returns:</span>
<span class="sd">            Point: A new Point R = k*Q</span>

<span class="sd">        Raises:</span>
<span class="sd">            ECPyException : with &quot;Point not on curve&quot;, if Point R is not </span>
<span class="sd">            on curve, thus meaning P was not on.</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Abstract method mul_point&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Curve.encode_point"><a class="viewcode-back" href="../../index.html#ecpy.curves.Curve.encode_point">[docs]</a>    <span class="k">def</span> <span class="nf">encode_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; encode/compress a point according to its curve&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Abstract method encode_point&#39;</span><span class="p">)</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="Curve.decode_point"><a class="viewcode-back" href="../../index.html#ecpy.curves.Curve.decode_point">[docs]</a>    <span class="k">def</span> <span class="nf">decode_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eP</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; decode/decompress a point according to its curve&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Abstract method _point decode_point&#39;</span><span class="p">)</span>
    
        <span class="k">pass</span></div>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">sign</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Generic Tonelli–Shanks algorithm &quot;&quot;&quot;</span>
        
        <span class="c1">#check Euler criterion</span>
        <span class="k">if</span> <span class="nb">pow</span><span class="p">(</span><span class="n">n</span><span class="p">,(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1">#compute square root</span>
        <span class="n">p_1</span> <span class="o">=</span> <span class="n">p</span><span class="o">-</span><span class="mi">1</span>
        <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">p_1</span>
        <span class="k">while</span> <span class="n">q</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="o">&gt;&gt;</span><span class="mi">1</span>
            <span class="n">s</span>  <span class="o">=</span> <span class="n">s</span><span class="o">+</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">n</span><span class="p">,(</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">4</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">z</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="k">while</span> <span class="nb">pow</span><span class="p">(</span><span class="n">z</span><span class="p">,(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">z</span> <span class="o">=</span> <span class="n">z</span><span class="o">+</span><span class="mi">1</span>
            <span class="n">c</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
            <span class="n">r</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">n</span><span class="p">,(</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
            <span class="n">t</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">s</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">m</span><span class="p">):</span>
                        <span class="k">if</span> <span class="nb">pow</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">i</span><span class="p">),</span><span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="k">break</span>
                    <span class="n">b</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">m</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">p</span><span class="p">)</span>
                    <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="n">b</span><span class="p">)</span>   <span class="o">%</span><span class="n">p</span>
                    <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">b</span><span class="p">)</span> <span class="o">%</span><span class="n">p</span>
                    <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">b</span><span class="p">)</span>   <span class="o">%</span><span class="n">p</span>
                    <span class="n">m</span> <span class="o">=</span> <span class="n">i</span>
        <span class="k">if</span> <span class="n">sign</span><span class="p">:</span>
            <span class="n">sign</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">r</span> <span class="o">&amp;</span><span class="mi">1</span> <span class="o">!=</span> <span class="n">sign</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">p</span><span class="o">-</span><span class="n">r</span>
        <span class="k">return</span> <span class="n">r</span></div>

    
<div class="viewcode-block" id="WeierstrassCurve"><a class="viewcode-back" href="../../index.html#ecpy.curves.WeierstrassCurve">[docs]</a><span class="k">class</span> <span class="nc">WeierstrassCurve</span><span class="p">(</span><span class="n">Curve</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An elliptic curve defined by the equation: y²=x³+a*x+b. </span>

<span class="sd">        The given domain must be a dictionary providing the following keys/values:</span>
<span class="sd">              - name (str)         : curve unique name</span>
<span class="sd">              - size (int)         : bit size</span>
<span class="sd">              - a    (int)         : `a` equation coefficient</span>
<span class="sd">              - b    (int)         : `b` equation coefficient</span>
<span class="sd">              - field (inf)        : field value </span>
<span class="sd">              - generator (int[2]) : x,y coordinate of generator</span>
<span class="sd">              - order (int)        : order of generator</span>
<span class="sd">              - cofactor (int)     : cofactor</span>
<span class="sd">        </span>
<span class="sd">        *Note*: you should not use the constructor and only use :func:`Curve.get_curve`</span>
<span class="sd">        builder to ensure using supported curve.</span>

<span class="sd">        Args:</span>
<span class="sd">           domain (dict): a dictionary providing curve parameters</span>

<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">domain</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Built an new short Weierstrass curve with the provided parameters. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_domain</span> <span class="o">=</span> <span class="p">{}</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;field&#39;</span><span class="p">,</span><span class="s1">&#39;generator&#39;</span><span class="p">,</span><span class="s1">&#39;order&#39;</span><span class="p">,</span><span class="s1">&#39;cofactor&#39;</span><span class="p">))</span>

    
<div class="viewcode-block" id="WeierstrassCurve.is_on_curve"><a class="viewcode-back" href="../../index.html#ecpy.curves.WeierstrassCurve.is_on_curve">[docs]</a>    <span class="k">def</span> <span class="nf">is_on_curve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; See :func:`Curve.is_on_curve` &quot;&quot;&quot;</span>
        <span class="n">q</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span>
        <span class="n">x</span>     <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">x</span>
        <span class="n">sq3x</span>  <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">y</span>     <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">y</span>
        <span class="n">sqy</span>   <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">left</span>  <span class="o">=</span> <span class="n">sqy</span>
        <span class="n">right</span> <span class="o">=</span> <span class="p">(</span><span class="n">sq3x</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="k">return</span> <span class="n">left</span> <span class="o">==</span> <span class="n">right</span></div>


<div class="viewcode-block" id="WeierstrassCurve.add_point"><a class="viewcode-back" href="../../index.html#ecpy.curves.WeierstrassCurve.add_point">[docs]</a>    <span class="k">def</span> <span class="nf">add_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; See :func:`Curve.add_point` &quot;&quot;&quot;</span>
        <span class="n">q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">P</span> <span class="o">==</span> <span class="n">Q</span><span class="p">):</span>
            <span class="n">Px</span><span class="p">,</span><span class="n">Py</span><span class="p">,</span><span class="n">Pz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aff2jac</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">P</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
            <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dbl_jac</span><span class="p">(</span><span class="n">Px</span><span class="p">,</span><span class="n">Py</span><span class="p">,</span><span class="n">Pz</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Px</span><span class="p">,</span><span class="n">Py</span><span class="p">,</span><span class="n">Pz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aff2jac</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">P</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
            <span class="n">Qx</span><span class="p">,</span><span class="n">Qy</span><span class="p">,</span><span class="n">Qz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aff2jac</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">Q</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>            
            <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_jac</span><span class="p">(</span><span class="n">Px</span><span class="p">,</span><span class="n">Py</span><span class="p">,</span><span class="n">Pz</span><span class="p">,</span> <span class="n">Qx</span><span class="p">,</span><span class="n">Qy</span><span class="p">,</span><span class="n">Qz</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>        
        <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_jac2aff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
        <span class="n">PQ</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">PQ</span></div>

        
<div class="viewcode-block" id="WeierstrassCurve.mul_point"><a class="viewcode-back" href="../../index.html#ecpy.curves.WeierstrassCurve.mul_point">[docs]</a>    <span class="k">def</span> <span class="nf">mul_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; See :func:`Curve.mul_point` &quot;&quot;&quot;</span>
        <span class="n">q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">z1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aff2jac</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">P</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
        <span class="n">k</span> <span class="o">=</span> <span class="nb">bin</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">k</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
        <span class="n">sz</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">z2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dbl_jac</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">z1</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">sz</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span> <span class="p">:</span>
                <span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">z1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_jac</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">z2</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">z1</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
                <span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">z2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dbl_jac</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">z2</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">z2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_jac</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">z1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">z2</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
                <span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">z1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dbl_jac</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">z1</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
        <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_jac2aff</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">z1</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="WeierstrassCurve.y_recover"><a class="viewcode-back" href="../../index.html#ecpy.curves.WeierstrassCurve.y_recover">[docs]</a>    <span class="k">def</span> <span class="nf">y_recover</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">sign</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; &quot;&quot;&quot;</span>
        <span class="n">p</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span>
        <span class="n">y2</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)</span><span class="o">%</span><span class="n">p</span>
        <span class="n">y</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sqrt</span><span class="p">(</span><span class="n">y2</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">sign</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">y</span></div>

<div class="viewcode-block" id="WeierstrassCurve.encode_point"><a class="viewcode-back" href="../../index.html#ecpy.curves.WeierstrassCurve.encode_point">[docs]</a>    <span class="k">def</span> <span class="nf">encode_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">compressed</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Encodes a point P according to *P1363-2000*.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            P: point to encode</span>

<span class="sd">        Returns</span>
<span class="sd">           bytes : encoded point [04 | x | y] or [02 | x | sign] </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="o">&gt;&gt;</span><span class="mi">3</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="s1">&#39;big&#39;</span><span class="p">))</span>
        <span class="n">y</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="s1">&#39;big&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">compressed</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">P</span><span class="o">.</span><span class="n">y</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">enc</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">enc</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">enc</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">enc</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">enc</span></div>

<div class="viewcode-block" id="WeierstrassCurve.decode_point"><a class="viewcode-back" href="../../index.html#ecpy.curves.WeierstrassCurve.decode_point">[docs]</a>    <span class="k">def</span> <span class="nf">decode_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eP</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Decodes a point P according to *P1363-2000*.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            eP (bytes)    : encoded point</span>
<span class="sd">            curve (Curve) : curve on witch point is</span>
<span class="sd">        Returns</span>
<span class="sd">           Point : decoded point</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="o">&gt;&gt;</span><span class="mi">3</span>
        <span class="n">xy</span>    <span class="o">=</span>  <span class="nb">bytearray</span><span class="p">(</span><span class="n">eP</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="o">+</span><span class="n">size</span><span class="p">]</span>
            <span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;big&#39;</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_recover</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="o">+</span><span class="n">size</span><span class="p">])</span>  
        <span class="k">elif</span> <span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="o">+</span><span class="n">size</span><span class="p">]</span>
            <span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;big&#39;</span><span class="p">)</span>    
            <span class="n">y</span> <span class="o">=</span> <span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="o">+</span><span class="n">size</span><span class="p">:</span><span class="mi">1</span><span class="o">+</span><span class="n">size</span><span class="o">+</span><span class="n">size</span><span class="p">]</span>
            <span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;big&#39;</span><span class="p">)</span>    
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ECPyException</span><span class="p">(</span><span class="s2">&quot;Invalid encoded point&quot;</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span></div>
        
        
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_aff2jac</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="k">return</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_jac2aff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="n">invz</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">q</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">q</span><span class="p">)</span>
        <span class="n">sqinvz</span> <span class="o">=</span> <span class="p">(</span><span class="n">invz</span><span class="o">*</span><span class="n">invz</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">sqinvz</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">sqinvz</span><span class="o">*</span><span class="n">invz</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_dbl_jac</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span><span class="n">Y1</span><span class="p">,</span><span class="n">Z1</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="n">XX</span>   <span class="o">=</span> <span class="p">(</span><span class="n">X1</span><span class="o">*</span><span class="n">X1</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">YY</span>   <span class="o">=</span> <span class="p">(</span><span class="n">Y1</span><span class="o">*</span><span class="n">Y1</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">YYYY</span> <span class="o">=</span> <span class="p">(</span><span class="n">YY</span><span class="o">*</span><span class="n">YY</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">ZZ</span>   <span class="o">=</span> <span class="p">(</span><span class="n">Z1</span><span class="o">*</span><span class="n">Z1</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">S</span>    <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">((</span><span class="n">X1</span><span class="o">+</span><span class="n">YY</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">X1</span><span class="o">+</span><span class="n">YY</span><span class="p">)</span><span class="o">-</span><span class="n">XX</span><span class="o">-</span><span class="n">YYYY</span><span class="p">))</span><span class="o">%</span><span class="n">q</span>
        <span class="n">M</span>    <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">XX</span><span class="o">+</span><span class="n">a</span><span class="o">*</span><span class="n">ZZ</span><span class="o">*</span><span class="n">ZZ</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">T</span>    <span class="o">=</span> <span class="p">(</span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">S</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">X3</span>   <span class="o">=</span> <span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">Y3</span>   <span class="o">=</span> <span class="p">(</span><span class="n">M</span><span class="o">*</span><span class="p">(</span><span class="n">S</span><span class="o">-</span><span class="n">T</span><span class="p">)</span><span class="o">-</span><span class="mi">8</span><span class="o">*</span><span class="n">YYYY</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">Z3</span>   <span class="o">=</span> <span class="p">((</span><span class="n">Y1</span><span class="o">+</span><span class="n">Z1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Y1</span><span class="o">+</span><span class="n">Z1</span><span class="p">)</span><span class="o">-</span><span class="n">YY</span><span class="o">-</span><span class="n">ZZ</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="k">return</span> <span class="n">X3</span><span class="p">,</span><span class="n">Y3</span><span class="p">,</span><span class="n">Z3</span>
        
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_add_jac</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span><span class="n">Y1</span><span class="p">,</span><span class="n">Z1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span><span class="n">Y2</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="n">Z1Z1</span> <span class="o">=</span> <span class="p">(</span><span class="n">Z1</span><span class="o">*</span><span class="n">Z1</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">Z2Z2</span> <span class="o">=</span> <span class="p">(</span><span class="n">Z2</span><span class="o">*</span><span class="n">Z2</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">U1</span>   <span class="o">=</span> <span class="p">(</span><span class="n">X1</span><span class="o">*</span><span class="n">Z2Z2</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">U2</span>   <span class="o">=</span> <span class="p">(</span><span class="n">X2</span><span class="o">*</span><span class="n">Z1Z1</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">S1</span>   <span class="o">=</span> <span class="p">(</span><span class="n">Y1</span><span class="o">*</span><span class="n">Z2</span><span class="o">*</span><span class="n">Z2Z2</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">S2</span>   <span class="o">=</span> <span class="p">(</span><span class="n">Y2</span><span class="o">*</span><span class="n">Z1</span><span class="o">*</span><span class="n">Z1Z1</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">H</span>    <span class="o">=</span> <span class="p">(</span><span class="n">U2</span><span class="o">-</span><span class="n">U1</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">I</span>    <span class="o">=</span> <span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">H</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">H</span><span class="p">))</span><span class="o">%</span><span class="n">q</span>
        <span class="n">J</span>    <span class="o">=</span> <span class="p">(</span><span class="n">H</span><span class="o">*</span><span class="n">I</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">r</span>    <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">S2</span><span class="o">-</span><span class="n">S1</span><span class="p">))</span><span class="o">%</span><span class="n">q</span>
        <span class="n">V</span>    <span class="o">=</span> <span class="p">(</span><span class="n">U1</span><span class="o">*</span><span class="n">I</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">X3</span>   <span class="o">=</span> <span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="n">r</span><span class="o">-</span><span class="n">J</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">V</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">Y3</span>   <span class="o">=</span> <span class="p">(</span><span class="n">r</span><span class="o">*</span><span class="p">(</span><span class="n">V</span><span class="o">-</span><span class="n">X3</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">S1</span><span class="o">*</span><span class="n">J</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">Z3</span>   <span class="o">=</span> <span class="p">(((</span><span class="n">Z1</span><span class="o">+</span><span class="n">Z2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Z1</span><span class="o">+</span><span class="n">Z2</span><span class="p">)</span><span class="o">-</span><span class="n">Z1Z1</span><span class="o">-</span><span class="n">Z2Z2</span><span class="p">)</span><span class="o">*</span><span class="n">H</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="k">return</span> <span class="n">X3</span><span class="p">,</span><span class="n">Y3</span><span class="p">,</span><span class="n">Z3</span></div>


<div class="viewcode-block" id="TwistedEdwardCurve"><a class="viewcode-back" href="../../index.html#ecpy.curves.TwistedEdwardCurve">[docs]</a><span class="k">class</span> <span class="nc">TwistedEdwardCurve</span><span class="p">(</span><span class="n">Curve</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An elliptic curve defined by the equation: a*x²+y²=1+d*x²*y² </span>
<span class="sd">    </span>
<span class="sd">        The given domain must be a dictionary providing the following keys/values:</span>
<span class="sd">              - name (str)         : curve unique name</span>
<span class="sd">              - size (int)         : bit size</span>
<span class="sd">              - a    (int)         : `a` equation coefficient</span>
<span class="sd">              - d    (int)         : `b` equation coefficient</span>
<span class="sd">              - field (inf)        : field value </span>
<span class="sd">              - generator (int[2]) : x,y coordinate of generator</span>
<span class="sd">              - order (int)        : order of generator</span>

<span class="sd">        *Note*: you should not use the constructor and only use :func:`Curve.get_curve`</span>
<span class="sd">        builder to ensure using supported curve.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">           domain (dict): a dictionary providing curve domain parameters</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">domain</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Built an new short twisted Edward curve with the provided parameters.  &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_domain</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;type&#39;</span><span class="p">,</span><span class="s1">&#39;size&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;field&#39;</span><span class="p">,</span><span class="s1">&#39;generator&#39;</span><span class="p">,</span><span class="s1">&#39;order&#39;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_coord_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;Ed25519&#39;</span><span class="p">:</span>
            <span class="n">size</span> <span class="o">=</span> <span class="mi">32</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;Ed448&#39;</span><span class="p">:</span>
            <span class="n">size</span> <span class="o">=</span> <span class="mi">57</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> not supported&#39;</span><span class="o">%</span><span class="n">curve</span><span class="o">.</span><span class="n">name</span>
        <span class="k">return</span> <span class="n">size</span>

<div class="viewcode-block" id="TwistedEdwardCurve.is_on_curve"><a class="viewcode-back" href="../../index.html#ecpy.curves.TwistedEdwardCurve.is_on_curve">[docs]</a>    <span class="k">def</span> <span class="nf">is_on_curve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; See :func:`Curve.is_on_curve` &quot;&quot;&quot;</span>
        <span class="n">q</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span>
        <span class="n">x</span>     <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">x</span>
        <span class="n">sqx</span>   <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">y</span>     <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">y</span>
        <span class="n">sqy</span>   <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">left</span>  <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">*</span><span class="n">sqx</span><span class="o">+</span><span class="n">sqy</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">right</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">d</span><span class="o">*</span><span class="n">sqx</span><span class="o">*</span><span class="n">sqy</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="k">return</span> <span class="n">left</span> <span class="o">==</span> <span class="n">right</span></div>
    
<div class="viewcode-block" id="TwistedEdwardCurve.x_recover"><a class="viewcode-back" href="../../index.html#ecpy.curves.TwistedEdwardCurve.x_recover">[docs]</a>    <span class="k">def</span> <span class="nf">x_recover</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sign</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>        
        <span class="sd">&quot;&quot;&quot; Retrieves the x coordinate according to the y one, \</span>
<span class="sd">            such that point (x,y) is on curve.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            y (int): y coordinate</span>
<span class="sd">            sign (int): sign of x</span>

<span class="sd">        Returns:</span>
<span class="sd">           int: the computed x coordinate</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">d</span>
        <span class="k">if</span> <span class="n">sign</span><span class="p">:</span>
            <span class="n">sign</span> <span class="o">=</span> <span class="mi">1</span>
        
        <span class="c1"># #x2 = (y^2-1) * (d*y^2-a)^-1</span>
        <span class="n">yy</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">u</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">yy</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">v</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">d</span><span class="o">*</span><span class="n">yy</span><span class="p">,</span><span class="n">q</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">q</span><span class="p">)</span>
        <span class="n">xx</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="n">v</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span><span class="s1">&#39;Ed25519&#39;</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">xx</span><span class="p">,(</span><span class="n">q</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">//</span><span class="mi">8</span><span class="p">,</span><span class="n">q</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">xx</span><span class="p">)</span> <span class="o">%</span> <span class="n">q</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">I</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">4</span><span class="p">,</span><span class="n">q</span><span class="p">)</span>
                <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">I</span><span class="p">)</span> <span class="o">%</span> <span class="n">q</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span><span class="s1">&#39;Ed448&#39;</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">xx</span><span class="p">,(</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">4</span><span class="p">,</span><span class="n">q</span><span class="p">)</span>      
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> not supported&#39;</span><span class="o">%</span><span class="n">curve</span><span class="o">.</span><span class="n">name</span>

        <span class="k">if</span> <span class="n">x</span> <span class="o">&amp;</span><span class="mi">1</span> <span class="o">!=</span> <span class="n">sign</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">q</span><span class="o">-</span><span class="n">x</span>

        <span class="k">assert</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">%</span><span class="n">q</span> <span class="o">==</span> <span class="n">xx</span>


        <span class="c1"># over F(q):</span>
        <span class="c1">#     a.xx +yy = 1+d.xx.yy</span>
        <span class="c1"># &lt;=&gt; xx(a-d.yy) = 1-yy</span>
        <span class="c1"># &lt;=&gt; xx = (1-yy)/(a-d.yy)</span>
        <span class="c1"># &lt;=&gt; x = +- sqrt((1-yy)/(a-d.yy))</span>
        <span class="c1"># yy   = (y*y)%q</span>
        <span class="c1"># u    = (1-yy)%q</span>
        <span class="c1"># v    = (a - d*yy)%q</span>
        <span class="c1"># v_1 = pow(v, q-2,q)</span>
        <span class="c1"># xx = (v_1*u)%q</span>
        <span class="c1"># x = self._sqrt(xx,q,sign) # Inherited generic Tonelli–Shanks from Curve </span>
        <span class="k">return</span> <span class="n">x</span></div>

<div class="viewcode-block" id="TwistedEdwardCurve.encode_point"><a class="viewcode-back" href="../../index.html#ecpy.curves.TwistedEdwardCurve.encode_point">[docs]</a>    <span class="k">def</span> <span class="nf">encode_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Encodes a point P according to *draft_irtf-cfrg-eddsa-04*.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            P: point to encode</span>

<span class="sd">        Returns</span>
<span class="sd">           bytes : encoded point</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coord_size</span><span class="p">()</span>

        <span class="n">y</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="s1">&#39;little&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">P</span><span class="o">.</span><span class="n">x</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">y</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">|=</span> <span class="mh">0x80</span>
        <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">y</span><span class="p">)</span></div>

<div class="viewcode-block" id="TwistedEdwardCurve.decode_point"><a class="viewcode-back" href="../../index.html#ecpy.curves.TwistedEdwardCurve.decode_point">[docs]</a>    <span class="k">def</span> <span class="nf">decode_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eP</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Decodes a point P according to *draft_irtf-cfrg-eddsa-04*.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            eP (bytes)    : encoded point</span>
<span class="sd">            curve (Curve) : curve on witch point is</span>
<span class="sd">        Returns</span>
<span class="sd">           Point : decoded point</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">y</span>    <span class="o">=</span>  <span class="nb">bytearray</span><span class="p">(</span><span class="n">eP</span><span class="p">)</span>
        <span class="n">sign</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x80</span>
        <span class="n">y</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="mh">0x80</span>
        <span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;little&#39;</span><span class="p">)</span>    
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_recover</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">sign</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="kc">True</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="TwistedEdwardCurve.add_point"><a class="viewcode-back" href="../../index.html#ecpy.curves.TwistedEdwardCurve.add_point">[docs]</a>    <span class="k">def</span> <span class="nf">add_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; See :func:`Curve.add_point` &quot;&quot;&quot;</span>
        <span class="n">q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">P</span> <span class="o">==</span> <span class="n">Q</span><span class="p">):</span>
            <span class="n">Px</span><span class="p">,</span><span class="n">Py</span><span class="p">,</span><span class="n">Pz</span><span class="p">,</span><span class="n">Pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aff2ext</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">P</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
            <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">t</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dbl_ext</span><span class="p">(</span><span class="n">Px</span><span class="p">,</span><span class="n">Py</span><span class="p">,</span><span class="n">Pz</span><span class="p">,</span><span class="n">Pt</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Px</span><span class="p">,</span><span class="n">Py</span><span class="p">,</span><span class="n">Pz</span><span class="p">,</span><span class="n">Pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aff2ext</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">P</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
            <span class="n">Qx</span><span class="p">,</span><span class="n">Qy</span><span class="p">,</span><span class="n">Qz</span><span class="p">,</span><span class="n">Qt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aff2ext</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">Q</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
            <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">t</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_ext</span><span class="p">(</span><span class="n">Px</span><span class="p">,</span><span class="n">Py</span><span class="p">,</span><span class="n">Pz</span><span class="p">,</span><span class="n">Pt</span><span class="p">,</span> <span class="n">Qx</span><span class="p">,</span><span class="n">Qy</span><span class="p">,</span><span class="n">Qz</span><span class="p">,</span><span class="n">Qt</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
        <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ext2aff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">t</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="TwistedEdwardCurve.mul_point"><a class="viewcode-back" href="../../index.html#ecpy.curves.TwistedEdwardCurve.mul_point">[docs]</a>    <span class="k">def</span> <span class="nf">mul_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; See :func:`Curve.add_point` &quot;&quot;&quot;</span>
        <span class="n">q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">z1</span><span class="p">,</span><span class="n">t1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aff2ext</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">P</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
        <span class="n">k</span> <span class="o">=</span> <span class="nb">bin</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">k</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
        <span class="n">sz</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">z2</span><span class="p">,</span><span class="n">t2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dbl_ext</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">z1</span><span class="p">,</span><span class="n">t1</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">sz</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span> <span class="p">:</span>
                <span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">z1</span><span class="p">,</span><span class="n">t1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_ext</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">z2</span><span class="p">,</span><span class="n">t2</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">z1</span><span class="p">,</span><span class="n">t1</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
                <span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">z2</span><span class="p">,</span><span class="n">t2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dbl_ext</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">z2</span><span class="p">,</span><span class="n">t2</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">z2</span><span class="p">,</span><span class="n">t2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_ext</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">z1</span><span class="p">,</span><span class="n">t1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">z2</span><span class="p">,</span><span class="n">t2</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
                <span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">z1</span><span class="p">,</span><span class="n">t1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dbl_ext</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">z1</span><span class="p">,</span><span class="n">t1</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
        <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ext2aff</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">z1</span><span class="p">,</span><span class="n">t1</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span></div>

    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_aff2ext</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="n">z</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">)</span> <span class="o">%</span> <span class="n">q</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">z</span><span class="p">)</span> <span class="o">%</span> <span class="n">q</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">)</span> <span class="o">%</span> <span class="n">q</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_ext2aff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">xy</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
        <span class="n">invz</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">q</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">q</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">invz</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">invz</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_dbl_ext</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span><span class="n">Y1</span><span class="p">,</span><span class="n">Z1</span><span class="p">,</span><span class="n">XY1</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span><span class="n">a</span><span class="p">):</span>
        <span class="n">A</span>  <span class="o">=</span> <span class="p">(</span><span class="n">X1</span><span class="o">*</span><span class="n">X1</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">B</span>  <span class="o">=</span> <span class="p">(</span><span class="n">Y1</span><span class="o">*</span><span class="n">Y1</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">C</span>  <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Z1</span><span class="o">*</span><span class="n">Z1</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">D</span>  <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">A</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">E</span>  <span class="o">=</span> <span class="p">((</span><span class="n">X1</span><span class="o">+</span><span class="n">Y1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">X1</span><span class="o">+</span><span class="n">Y1</span><span class="p">)</span><span class="o">-</span><span class="n">A</span><span class="o">-</span><span class="n">B</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">G</span>  <span class="o">=</span> <span class="p">(</span><span class="n">D</span><span class="o">+</span><span class="n">B</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">F</span>  <span class="o">=</span> <span class="p">(</span><span class="n">G</span><span class="o">-</span><span class="n">C</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">H</span>  <span class="o">=</span> <span class="p">(</span><span class="n">D</span><span class="o">-</span><span class="n">B</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">X3</span>  <span class="o">=</span> <span class="p">(</span><span class="n">E</span><span class="o">*</span><span class="n">F</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">Y3</span>  <span class="o">=</span> <span class="p">(</span><span class="n">G</span><span class="o">*</span><span class="n">H</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">XY3</span> <span class="o">=</span> <span class="p">(</span><span class="n">E</span><span class="o">*</span><span class="n">H</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">Z3</span>  <span class="o">=</span> <span class="p">(</span><span class="n">F</span><span class="o">*</span><span class="n">G</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">X3</span><span class="p">,</span><span class="n">Y3</span><span class="p">,</span><span class="n">Z3</span><span class="p">,</span><span class="n">XY3</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_add_ext</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span><span class="n">Y1</span><span class="p">,</span><span class="n">Z1</span><span class="p">,</span><span class="n">XY1</span><span class="p">,</span>  <span class="n">X2</span><span class="p">,</span><span class="n">Y2</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">XY2</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span><span class="n">a</span><span class="p">):</span>
        <span class="n">A</span> <span class="o">=</span> <span class="p">(</span><span class="n">X1</span><span class="o">*</span><span class="n">X2</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">B</span> <span class="o">=</span> <span class="p">(</span><span class="n">Y1</span><span class="o">*</span><span class="n">Y2</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">C</span> <span class="o">=</span> <span class="p">(</span><span class="n">Z1</span><span class="o">*</span><span class="n">XY2</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">D</span> <span class="o">=</span> <span class="p">(</span><span class="n">XY1</span><span class="o">*</span><span class="n">Z2</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">E</span> <span class="o">=</span> <span class="p">(</span><span class="n">D</span><span class="o">+</span><span class="n">C</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="p">(</span><span class="n">X1</span><span class="o">-</span><span class="n">Y1</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="p">(</span><span class="n">X2</span><span class="o">+</span><span class="n">Y2</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">t2</span> <span class="o">=</span> <span class="p">(</span><span class="n">t0</span><span class="o">*</span><span class="n">t1</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">t3</span> <span class="o">=</span> <span class="p">(</span><span class="n">t2</span><span class="o">+</span><span class="n">B</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">F</span> <span class="o">=</span> <span class="p">(</span><span class="n">t3</span><span class="o">-</span><span class="n">A</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">t4</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">A</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">G</span> <span class="o">=</span> <span class="p">(</span><span class="n">B</span><span class="o">+</span><span class="n">t4</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">H</span> <span class="o">=</span> <span class="p">(</span><span class="n">D</span><span class="o">-</span><span class="n">C</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">X3</span> <span class="o">=</span> <span class="p">(</span><span class="n">E</span><span class="o">*</span><span class="n">F</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">Y3</span> <span class="o">=</span> <span class="p">(</span><span class="n">G</span><span class="o">*</span><span class="n">H</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">XY3</span> <span class="o">=</span> <span class="p">(</span><span class="n">E</span><span class="o">*</span><span class="n">H</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="n">Z3</span> <span class="o">=</span> <span class="p">(</span><span class="n">F</span><span class="o">*</span><span class="n">G</span><span class="p">)</span><span class="o">%</span><span class="n">q</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">X3</span><span class="p">,</span><span class="n">Y3</span><span class="p">,</span><span class="n">Z3</span><span class="p">,</span><span class="n">XY3</span><span class="p">)</span></div>
        
      
<div class="viewcode-block" id="MontgomeryCurve"><a class="viewcode-back" href="../../index.html#ecpy.curves.MontgomeryCurve">[docs]</a><span class="k">class</span> <span class="nc">MontgomeryCurve</span><span class="p">(</span><span class="n">Curve</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An elliptic curve defined by the equation: b.y²=x³+a*x²+x.  </span>
<span class="sd">    </span>
<span class="sd">        The given domain must be a dictionary providing the following keys/values:</span>
<span class="sd">              - name (str)         : curve unique name</span>
<span class="sd">              - size (int)         : bit size</span>
<span class="sd">              - a    (int)         : `a` equation coefficient</span>
<span class="sd">              - b    (int)         : `b` equation coefficient</span>
<span class="sd">              - field (inf)        : field value </span>
<span class="sd">              - generator (int[2]) : x,y coordinate of generator</span>
<span class="sd">              - order (int)        : order of generator</span>

<span class="sd">        *Note*: you should not use the constructor and only use :func:`Curve.get_curve`</span>
<span class="sd">        builder to ensure using supported curve.</span>

<span class="sd">        Args:</span>
<span class="sd">           domain (dict): a dictionary providing curve domain parameters</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">domain</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Built an new short twisted Edward curve with the provided parameters.  &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_domain</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;type&#39;</span><span class="p">,</span><span class="s1">&#39;size&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;field&#39;</span><span class="p">,</span><span class="s1">&#39;generator&#39;</span><span class="p">,</span><span class="s1">&#39;order&#39;</span><span class="p">))</span>
        <span class="c1">#inv4 = pow(4,p-2,p)</span>
        <span class="c1">#self.a24  = ((self.a+2)*inv4)%p</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a24</span>  <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">//</span><span class="mi">4</span>

<div class="viewcode-block" id="MontgomeryCurve.is_on_curve"><a class="viewcode-back" href="../../index.html#ecpy.curves.MontgomeryCurve.is_on_curve">[docs]</a>    <span class="k">def</span> <span class="nf">is_on_curve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; See :func:`Curve.is_on_curve` &quot;&quot;&quot;</span>
        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">x</span>
        <span class="n">right</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="o">%</span><span class="n">p</span>
        <span class="k">if</span> <span class="n">P</span><span class="o">.</span><span class="n">y</span><span class="p">:</span>
            <span class="n">y</span>     <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">y</span>
            <span class="n">left</span>  <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">%</span><span class="n">p</span>
            <span class="k">return</span> <span class="n">left</span> <span class="o">==</span> <span class="n">right</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#check equation has a solution according to Euler criterion</span>
            <span class="k">return</span> <span class="nb">pow</span><span class="p">(</span><span class="n">right</span><span class="p">,(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="MontgomeryCurve.y_recover"><a class="viewcode-back" href="../../index.html#ecpy.curves.MontgomeryCurve.y_recover">[docs]</a>    <span class="k">def</span> <span class="nf">y_recover</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">sign</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; &quot;&quot;&quot;</span>
        <span class="n">p</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span>
        <span class="n">y2</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="o">%</span><span class="n">p</span>
        <span class="n">y</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sqrt</span><span class="p">(</span><span class="n">y2</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">sign</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">y</span></div>
     
<div class="viewcode-block" id="MontgomeryCurve.encode_point"><a class="viewcode-back" href="../../index.html#ecpy.curves.MontgomeryCurve.encode_point">[docs]</a>    <span class="k">def</span> <span class="nf">encode_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Encodes a point P according to *RFC7748*.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            P: point to encode</span>

<span class="sd">        Returns</span>
<span class="sd">           bytes : encoded point</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="o">&gt;&gt;</span><span class="mi">3</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="s1">&#39;little&#39;</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></div>

<div class="viewcode-block" id="MontgomeryCurve.decode_point"><a class="viewcode-back" href="../../index.html#ecpy.curves.MontgomeryCurve.decode_point">[docs]</a>    <span class="k">def</span> <span class="nf">decode_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eP</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Decodes a point P according to *RFC7748*.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            eP (bytes)    : encoded point</span>
<span class="sd">            curve (Curve) : curve on witch point is</span>
<span class="sd">        Returns</span>
<span class="sd">           Point : decoded point</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span>    <span class="o">=</span>  <span class="nb">bytearray</span><span class="p">(</span><span class="n">eP</span><span class="p">)</span>
        <span class="n">x</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="mh">0x80</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;little&#39;</span><span class="p">)</span>    
        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="MontgomeryCurve.mul_point"><a class="viewcode-back" href="../../index.html#ecpy.curves.MontgomeryCurve.mul_point">[docs]</a>    <span class="k">def</span> <span class="nf">mul_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">P</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; See :func:`Curve.add_point` &quot;&quot;&quot;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mul_point_x</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">P</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="n">curve</span><span class="p">)</span></div>
    
    <span class="k">def</span> <span class="nf">_mul_point_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">u</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;  &quot;&quot;&quot;</span>        


        <span class="n">k</span> <span class="o">=</span> <span class="nb">bin</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">k</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
        <span class="n">sz</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="n">u</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">z2</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">x3</span> <span class="o">=</span> <span class="n">u</span>
        <span class="n">z3</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sz</span><span class="p">):</span>
            <span class="n">ki</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>           
            <span class="k">if</span> <span class="n">ki</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">x3</span><span class="p">,</span><span class="n">z3</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span><span class="n">z2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ladder_step</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span><span class="n">z3</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span><span class="n">z2</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">x2</span><span class="p">,</span><span class="n">z2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span><span class="n">z3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ladder_step</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span><span class="n">z2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span><span class="n">z3</span><span class="p">)</span> 
        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span>
        <span class="n">zinv</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">z2</span><span class="p">,(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">2</span><span class="p">),</span><span class="n">p</span><span class="p">)</span>
        <span class="n">ku</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2</span><span class="o">*</span><span class="n">zinv</span><span class="p">)</span><span class="o">%</span><span class="n">p</span>
        <span class="k">return</span> <span class="n">ku</span>

    <span class="k">def</span> <span class="nf">_ladder_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_qp</span><span class="p">,</span> <span class="n">x_p</span><span class="p">,</span><span class="n">z_p</span><span class="p">,</span> <span class="n">x_q</span><span class="p">,</span><span class="n">z_q</span><span class="p">):</span>
        <span class="n">p</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span>

        <span class="n">t1</span>   <span class="o">=</span> <span class="p">(</span><span class="n">x_p</span> <span class="o">+</span> <span class="n">z_p</span><span class="p">)</span>              <span class="o">%</span><span class="n">p</span>
        <span class="n">t6</span>   <span class="o">=</span> <span class="p">(</span><span class="n">t1</span>  <span class="o">*</span> <span class="n">t1</span><span class="p">)</span>               <span class="o">%</span><span class="n">p</span>
        <span class="n">t2</span>   <span class="o">=</span> <span class="p">(</span><span class="n">x_p</span> <span class="o">-</span> <span class="n">z_p</span><span class="p">)</span>              <span class="o">%</span><span class="n">p</span>
        <span class="n">t7</span>   <span class="o">=</span> <span class="p">(</span><span class="n">t2</span>  <span class="o">*</span> <span class="n">t2</span><span class="p">)</span>               <span class="o">%</span><span class="n">p</span>
        <span class="n">t5</span>   <span class="o">=</span> <span class="p">(</span><span class="n">t6</span>  <span class="o">-</span> <span class="n">t7</span><span class="p">)</span>               <span class="o">%</span><span class="n">p</span>
        <span class="n">t3</span>   <span class="o">=</span> <span class="p">(</span><span class="n">x_q</span> <span class="o">+</span> <span class="n">z_q</span><span class="p">)</span>              <span class="o">%</span><span class="n">p</span>
        <span class="n">t4</span>   <span class="o">=</span> <span class="p">(</span><span class="n">x_q</span> <span class="o">-</span> <span class="n">z_q</span><span class="p">)</span>              <span class="o">%</span><span class="n">p</span>
        <span class="n">t8</span>   <span class="o">=</span> <span class="p">(</span><span class="n">t4</span>  <span class="o">*</span> <span class="n">t1</span><span class="p">)</span>               <span class="o">%</span><span class="n">p</span>
        <span class="n">t9</span>   <span class="o">=</span> <span class="p">(</span><span class="n">t3</span>  <span class="o">*</span> <span class="n">t2</span><span class="p">)</span>               <span class="o">%</span><span class="n">p</span>

        <span class="n">x_pq</span> <span class="o">=</span> <span class="p">((</span><span class="n">t8</span><span class="o">+</span><span class="n">t9</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t8</span><span class="o">+</span><span class="n">t9</span><span class="p">))</span>        <span class="o">%</span><span class="n">p</span>
        <span class="n">z_pq</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_qp</span><span class="o">*</span><span class="p">(</span><span class="n">t8</span><span class="o">-</span><span class="n">t9</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t8</span><span class="o">-</span><span class="n">t9</span><span class="p">))</span>   <span class="o">%</span><span class="n">p</span>
        <span class="n">x_2p</span> <span class="o">=</span> <span class="p">(</span><span class="n">t6</span><span class="o">*</span><span class="n">t7</span><span class="p">)</span><span class="o">%</span><span class="n">p</span>                <span class="o">%</span><span class="n">p</span>
        <span class="n">z_2p</span> <span class="o">=</span> <span class="p">(</span><span class="n">t5</span><span class="o">*</span><span class="p">(</span><span class="n">t7</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">a24</span><span class="o">*</span><span class="n">t5</span><span class="p">))</span>     <span class="o">%</span><span class="n">p</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">x_2p</span><span class="p">,</span> <span class="n">z_2p</span><span class="p">,</span> <span class="n">x_pq</span><span class="p">,</span> <span class="n">z_pq</span><span class="p">)</span></div>


<div class="viewcode-block" id="Point"><a class="viewcode-back" href="../../index.html#ecpy.curves.Point">[docs]</a><span class="k">class</span> <span class="nc">Point</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Immutable Elliptic Curve Point.</span>

<span class="sd">    A Point support the following operator:</span>
<span class="sd">    </span>
<span class="sd">        - `+` : Point Addition, with automatic doubling support.</span>
<span class="sd">        - `*` : Scalar multiplication, can write as k*P or P*k, with P :class:Point and  k :class:int</span>
<span class="sd">        - `==`: Point comparison</span>
<span class="sd">    </span>
<span class="sd">    Attributes:</span>
<span class="sd">        x (int)       : Affine x coordinate </span>
<span class="sd">        y (int)       : Affine y coordinate </span>
<span class="sd">        curve (Curve) : Curve on which the point is define</span>


<span class="sd">    Args:</span>
<span class="sd">        x (int) :     x coordinate</span>
<span class="sd">        y (int) :     y coordinate</span>
<span class="sd">        check (bool): if True enforce x,y is on curve</span>

<span class="sd">    Raises:</span>
<span class="sd">        ECPyException : if check=True and x,y is not on curve </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="s1">&#39;_x&#39;</span><span class="p">,</span><span class="s1">&#39;_y&#39;</span><span class="p">,</span><span class="s1">&#39;_curve&#39;</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">curve</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">_curve</span> <span class="o">=</span> <span class="n">curve</span> 
        <span class="k">if</span> <span class="n">x</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">y</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">y</span><span class="p">:</span>
            <span class="n">check</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">check</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">curve</span><span class="o">.</span><span class="n">is_on_curve</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">ECPyException</span><span class="p">(</span><span class="s2">&quot;Point not on curve&quot;</span><span class="p">)</span>
        
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">curve</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_curve</span>
        
    <span class="k">def</span> <span class="nf">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">curve</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">curve</span>
        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">curve</span><span class="o">.</span><span class="n">field</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">curve</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Q</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="n">Point</span><span class="p">)</span> <span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">curve</span><span class="o">.</span><span class="n">add_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Q</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;__add__: type not supported: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="nb">type</span><span class="p">(</span><span class="n">Q</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Q</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="n">Point</span><span class="p">)</span> <span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">curve</span><span class="o">.</span><span class="n">sub_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Q</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;__sub__: type not supported: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="nb">type</span><span class="p">(</span><span class="n">Q</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scal</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">curve</span><span class="o">.</span><span class="n">mul_point</span><span class="p">(</span><span class="n">scal</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;__mul__: type not supported: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="nb">type</span><span class="p">(</span><span class="n">scal</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">scal</span><span class="p">)</span> <span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__mul__</span><span class="p">(</span><span class="n">scal</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Q</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="n">Point</span><span class="p">)</span> <span class="p">:</span>
            <span class="k">return</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_curve</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">Q</span><span class="o">.</span><span class="n">_curve</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">_curve</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span>
                     <span class="n">Q</span><span class="o">.</span><span class="n">_curve</span><span class="o">.</span><span class="n">name</span>    <span class="o">==</span> <span class="kc">None</span> <span class="p">)</span> <span class="ow">and</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">==</span> <span class="n">Q</span><span class="o">.</span><span class="n">_x</span> <span class="ow">and</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">==</span> <span class="n">Q</span><span class="o">.</span><span class="n">_y</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;eq: type not supported: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">Q</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;x: </span><span class="si">%x</span><span class="se">\n</span><span class="s2">  y: </span><span class="si">%x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">neg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__neg__</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Q</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">sub</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Q</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__sub__</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">mul</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__mul__</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">eq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Q</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span></div>



<div class="viewcode-block" id="ECPyException"><a class="viewcode-back" href="../../index.html#ecpy.curves.ECPyException">[docs]</a><span class="k">class</span> <span class="nc">ECPyException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">rept</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>



    
<span class="n">WEIERSTRASS</span>   <span class="o">=</span> <span class="s2">&quot;weierstrass&quot;</span>
<span class="n">TWISTEDEDWARD</span> <span class="o">=</span> <span class="s2">&quot;twistededward&quot;</span>
<span class="n">MONTGOMERY</span>     <span class="o">=</span> <span class="s2">&quot;montgomery&quot;</span>


<span class="n">curves</span> <span class="o">=</span> <span class="p">[</span>

    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;frp256v1&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">WEIERSTRASS</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">256</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0xF1FD178C0B3AD58F10126DE8CE42435B3961ADBCABC8CA6DE8FCF353D86E9C03</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mh">0xB6B3D4C356C139EB31183D4749D423958C27D2DCAF98B70164C97A2DD98F5CFF</span><span class="p">,</span>
                      <span class="mh">0x6142E0F7C8B204911F9271F0F3ECEF8C2701C307E8E4C9E183115A1554062CFB</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0xF1FD178C0B3AD58F10126DE8CE42435B53DC67E140D2BF941FFDD459C6D655E1</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mh">0xF1FD178C0B3AD58F10126DE8CE42435B3961ADBCABC8CA6DE8FCF353D86E9C00</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span>         <span class="mh">0xEE353FCA5428A9300D4ABA754A44C00FDFEC0C9AE4B1A1803075ED967B7BB73F</span><span class="p">,</span>
        
    <span class="p">},</span>

    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;secp521r1&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">WEIERSTRASS</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">521</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0x01FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mh">0x00C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66</span><span class="p">,</span>
                      <span class="mh">0x011839296A789A3BC0045C8A5FB42C7D1BD998F54449579B446817AFBD17273E662C97EE72995EF42640C550B9013FAD0761353C7086A272C24088BE94769FD16650</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0x01FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mh">0x01FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span>         <span class="mh">0x0051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00</span><span class="p">,</span>
        
    <span class="p">},</span>

    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;secp384r1&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">WEIERSTRASS</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">384</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mh">0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7</span><span class="p">,</span>
                      <span class="mh">0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mh">0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span>         <span class="mh">0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef</span><span class="p">,</span>
        
    <span class="p">},</span>

    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;secp256k1&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">WEIERSTRASS</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">256</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mh">0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798</span><span class="p">,</span>
                      <span class="mh">0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span>         <span class="mi">7</span>
        
    <span class="p">},</span>

    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;secp256r1&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">WEIERSTRASS</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">256</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mh">0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296</span><span class="p">,</span>
                      <span class="mh">0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mh">0x1</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mh">0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span>         <span class="mh">0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b</span>
    <span class="p">},</span>
    
    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;secp224k1&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">WEIERSTRASS</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">224</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFE56D</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mh">0xA1455B334DF099DF30FC28A169A467E9E47075A90F7E650EB6B7A45C</span><span class="p">,</span>
                      <span class="mh">0x7E089FED7FBA344282CAFBD6F7E319F7C0B0BD59E2CA4BDB556D61A5</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0x010000000000000000000000000001DCE8D2EC6184CAF0A971769FB1F7</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mh">0x1</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mh">0x0</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span>         <span class="mh">0x5</span><span class="p">,</span>
    <span class="p">},</span>
    
    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;secp224r1&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">WEIERSTRASS</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">224</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mh">0xB70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21</span> <span class="p">,</span>
                      <span class="mh">0xBD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0xFFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mh">0x1</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mh">0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span>         <span class="mh">0xB4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4</span>
    <span class="p">},</span>
    
    
    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;secp192k1&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">WEIERSTRASS</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">192</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0xfffffffffffffffffffffffffffffffffffffffeffffee37</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mh">0xdb4ff10ec057e9ae26b07d0280b7f4341da5d1b1eae06c7d</span><span class="p">,</span>
                      <span class="mh">0x9b2f2f6d9c5628a7844163d015be86344082aa88d95e2f9d</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0xfffffffffffffffffffffffe26f2fc170f69466a74defd8d</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mh">0x1</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mh">0x0</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span>         <span class="mh">0x3</span>
    <span class="p">},</span>
    
    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;secp192r1&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">WEIERSTRASS</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">256</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0xfffffffffffffffffffffffffffffffeffffffffffffffff</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mh">0x188da80eb03090f67cbf20eb43a18800f4ff0afd82ff1012</span><span class="p">,</span>
                      <span class="mh">0x7192b95ffc8da78631011ed6b24cdd573f977a11e794811</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0xffffffffffffffffffffffff99def836146bc9b1b4d22831</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mh">0x1</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mh">0xfffffffffffffffffffffffffffffffefffffffffffffffc</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span>         <span class="mh">0x64210519e59c80e70fa7e9ab72243049feb8deecc146b9b1</span>
    <span class="p">},</span>
    
    
    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;secp160k1&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">WEIERSTRASS</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">160</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0xfffffffffffffffffffffffffffffffeffffac73</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mh">0x3b4c382ce37aa192a4019e763036f4f5dd4d7ebb</span><span class="p">,</span>
                      <span class="mh">0x938cf935318fdced6bc28286531733c3f03c4fee</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0x100000000000000000001b8fa16dfab9aca16b6b3</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mh">0x1</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mh">0x0</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span>         <span class="mh">0x7</span>
    <span class="p">},</span>
    
    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;secp160r1&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">WEIERSTRASS</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">160</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0xffffffffffffffffffffffffffffffff7fffffff</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mh">0x4a96b5688ef573284664698968c38bb913cbfc82</span><span class="p">,</span>
                      <span class="mh">0x23a628553168947d59dcc912042351377ac5fb32</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0x100000000000000000001f4c8f927aed3ca752257</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mh">0x1</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mh">0xffffffffffffffffffffffffffffffff7ffffffc</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span>         <span class="mh">0x1c97befc54bd7a8b65acf89f81d4d4adc565fa45</span>
    <span class="p">},</span>
    
    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;secp160r2&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">WEIERSTRASS</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">160</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0xfffffffffffffffffffffffffffffffeffffac73</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mh">0x52dcb034293a117e1f4ff11b30f7199d3144ce6d</span><span class="p">,</span>
                      <span class="mh">0xfeaffef2e331f296e071fa0df9982cfea7d43f2e</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0x100000000000000000000351ee786a818f3a1a16b</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mh">0x1</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mh">0xfffffffffffffffffffffffffffffffeffffac70</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span>         <span class="mh">0xb4e134d3fb59eb8bab57274904664d5af50388ba</span>
    <span class="p">},</span>

    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;Brainpool-p512t1&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">WEIERSTRASS</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">512</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0xAADD9DB8DBE9C48B3FD4E6AE33C9FC07CB308DB3B3C9D20ED6639CCA703308717D4D9B009BC66842AECDA12AE6A380E62881FF2F2D82C68528AA6056583A48F3</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mh">0x640ECE5C12788717B9C1BA06CBC2A6FEBA85842458C56DDE9DB1758D39C0313D82BA51735CDB3EA499AA77A7D6943A64F7A3F25FE26F06B51BAA2696FA9035DA</span><span class="p">,</span>
                      <span class="mh">0x5B534BD595F5AF0FA2C892376C84ACE1BB4E3019B71634C01131159CAE03CEE9D9932184BEEF216BD71DF2DADF86A627306ECFF96DBB8BACE198B61E00F8B332</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0xAADD9DB8DBE9C48B3FD4E6AE33C9FC07CB308DB3B3C9D20ED6639CCA70330870553E5C414CA92619418661197FAC10471DB1D381085DDADDB58796829CA90069</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mh">0xAADD9DB8DBE9C48B3FD4E6AE33C9FC07CB308DB3B3C9D20ED6639CCA703308717D4D9B009BC66842AECDA12AE6A380E62881FF2F2D82C68528AA6056583A48F0</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span>         <span class="mh">0x7CBBBCF9441CFAB76E1890E46884EAE321F70C0BCB4981527897504BEC3E36A62BCDFA2304976540F6450085F2DAE145C22553B465763689180EA2571867423E</span><span class="p">,</span>
        
    <span class="p">},</span>

    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;Brainpool-p512r1&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">WEIERSTRASS</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">512</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0xAADD9DB8DBE9C48B3FD4E6AE33C9FC07CB308DB3B3C9D20ED6639CCA703308717D4D9B009BC66842AECDA12AE6A380E62881FF2F2D82C68528AA6056583A48F3</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mh">0x81AEE4BDD82ED9645A21322E9C4C6A9385ED9F70B5D916C1B43B62EEF4D0098EFF3B1F78E2D0D48D50D1687B93B97D5F7C6D5047406A5E688B352209BCB9F822</span><span class="p">,</span>
                      <span class="mh">0x7DDE385D566332ECC0EABFA9CF7822FDF209F70024A57B1AA000C55B881F8111B2DCDE494A5F485E5BCA4BD88A2763AED1CA2B2FA8F0540678CD1E0F3AD80892</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0xAADD9DB8DBE9C48B3FD4E6AE33C9FC07CB308DB3B3C9D20ED6639CCA70330870553E5C414CA92619418661197FAC10471DB1D381085DDADDB58796829CA90069</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mh">0x7830A3318B603B89E2327145AC234CC594CBDD8D3DF91610A83441CAEA9863BC2DED5D5AA8253AA10A2EF1C98B9AC8B57F1117A72BF2C7B9E7C1AC4D77FC94CA</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span>         <span class="mh">0x3DF91610A83441CAEA9863BC2DED5D5AA8253AA10A2EF1C98B9AC8B57F1117A72BF2C7B9E7C1AC4D77FC94CADC083E67984050B75EBAE5DD2809BD638016F723</span><span class="p">,</span>
        
    <span class="p">},</span>

    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;Brainpool-p384t1&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">WEIERSTRASS</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">384</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0x8CB91E82A3386D280F5D6F7E50E641DF152F7109ED5456B412B1DA197FB71123ACD3A729901D1A71874700133107EC53</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mh">0x18DE98B02DB9A306F2AFCD7235F72A819B80AB12EBD653172476FECD462AABFFC4FF191B946A5F54D8D0AA2F418808CC</span><span class="p">,</span>
                      <span class="mh">0x25AB056962D30651A114AFD2755AD336747F93475B7A1FCA3B88F2B6A208CCFE469408584DC2B2912675BF5B9E582928</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0x8CB91E82A3386D280F5D6F7E50E641DF152F7109ED5456B31F166E6CAC0425A7CF3AB6AF6B7FC3103B883202E9046565</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mh">0x8CB91E82A3386D280F5D6F7E50E641DF152F7109ED5456B412B1DA197FB71123ACD3A729901D1A71874700133107EC50</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span>         <span class="mh">0x7F519EADA7BDA81BD826DBA647910F8C4B9346ED8CCDC64E4B1ABD11756DCE1D2074AA263B88805CED70355A33B471EE</span><span class="p">,</span>
        
    <span class="p">},</span>
    
    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;Brainpool-p384r1&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">WEIERSTRASS</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">384</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0x8CB91E82A3386D280F5D6F7E50E641DF152F7109ED5456B412B1DA197FB71123ACD3A729901D1A71874700133107EC53</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mh">0x1D1C64F068CF45FFA2A63A81B7C13F6B8847A3E77EF14FE3DB7FCAFE0CBD10E8E826E03436D646AAEF87B2E247D4AF1E</span><span class="p">,</span>
                      <span class="mh">0x8ABE1D7520F9C2A45CB1EB8E95CFD55262B70B29FEEC5864E19C054FF99129280E4646217791811142820341263C5315</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0x8CB91E82A3386D280F5D6F7E50E641DF152F7109ED5456B31F166E6CAC0425A7CF3AB6AF6B7FC3103B883202E9046565</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mh">0x7BC382C63D8C150C3C72080ACE05AFA0C2BEA28E4FB22787139165EFBA91F90F8AA5814A503AD4EB04A8C7DD22CE2826</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span>         <span class="mh">0x04A8C7DD22CE28268B39B55416F0447C2FB77DE107DCD2A62E880EA53EEB62D57CB4390295DBC9943AB78696FA504C11</span><span class="p">,</span>
        
    <span class="p">},</span>

    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;Brainpool-p320t1&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">WEIERSTRASS</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">320</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0xD35E472036BC4FB7E13C785ED201E065F98FCFA6F6F40DEF4F92B9EC7893EC28FCD412B1F1B32E27</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mh">0x925BE9FB01AFC6FB4D3E7D4990010F813408AB106C4F09CB7EE07868CC136FFF3357F624A21BED52</span><span class="p">,</span>
                      <span class="mh">0x63BA3A7A27483EBF6671DBEF7ABB30EBEE084E58A0B077AD42A5A0989D1EE71B1B9BC0455FB0D2C3</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0xD35E472036BC4FB7E13C785ED201E065F98FCFA5B68F12A32D482EC7EE8658E98691555B44C59311</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mh">0xD35E472036BC4FB7E13C785ED201E065F98FCFA6F6F40DEF4F92B9EC7893EC28FCD412B1F1B32E24</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span>         <span class="mh">0xA7F561E038EB1ED560B3D147DB782013064C19F27ED27C6780AAF77FB8A547CEB5B4FEF422340353</span><span class="p">,</span>
        
    <span class="p">},</span>

    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;Brainpool-p320r1&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">WEIERSTRASS</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">320</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0xD35E472036BC4FB7E13C785ED201E065F98FCFA6F6F40DEF4F92B9EC7893EC28FCD412B1F1B32E27</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mh">0x43BD7E9AFB53D8B85289BCC48EE5BFE6F20137D10A087EB6E7871E2A10A599C710AF8D0D39E20611</span><span class="p">,</span>
                      <span class="mh">0x14FDD05545EC1CC8AB4093247F77275E0743FFED117182EAA9C77877AAAC6AC7D35245D1692E8EE1</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0xD35E472036BC4FB7E13C785ED201E065F98FCFA5B68F12A32D482EC7EE8658E98691555B44C59311</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mh">0x3EE30B568FBAB0F883CCEBD46D3F3BB8A2A73513F5EB79DA66190EB085FFA9F492F375A97D860EB4</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span>         <span class="mh">0x520883949DFDBC42D3AD198640688A6FE13F41349554B49ACC31DCCD884539816F5EB4AC8FB1F1A6</span><span class="p">,</span>
        
    <span class="p">},</span>
    
    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;Brainpool-p256r1&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">WEIERSTRASS</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">256</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0xa9fb57dba1eea9bc3e660a909d838d726e3bf623d52620282013481d1f6e5377</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mh">0x8bd2aeb9cb7e57cb2c4b482ffc81b7afb9de27e1e3bd23c23a4453bd9ace3262</span><span class="p">,</span>
                      <span class="mh">0x547ef835c3dac4fd97f8461a14611dc9c27745132ded8e545c1d54c72f046997</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0xa9fb57dba1eea9bc3e660a909d838d718c397aa3b561a6f7901e0e82974856a7</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mh">0x1</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mh">0x7d5a0975fc2c3057eef67530417affe7fb8055c126dc5c6ce94a4b44f330b5d9</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span>         <span class="mh">0x26dc5c6ce94a4b44f330b5d9bbd77cbf958416295cf7e1ce6bccdc18ff8c07b6</span>
    <span class="p">},</span>
    
    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;Brainpool-p256t1&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">WEIERSTRASS</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">256</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0xa9fb57dba1eea9bc3e660a909d838d726e3bf623d52620282013481d1f6e5377</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mh">0xa3e8eb3cc1cfe7b7732213b23a656149afa142c47aafbc2b79a191562e1305f4</span><span class="p">,</span>
                      <span class="mh">0x2d996c823439c56d7f7b22e14644417e69bcb6de39d027001dabe8f35b25c9be</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0xa9fb57dba1eea9bc3e660a909d838d718c397aa3b561a6f7901e0e82974856a7</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mh">0x1</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mh">0xa9fb57dba1eea9bc3e660a909d838d726e3bf623d52620282013481d1f6e5374</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span>         <span class="mh">0x662c61c430d84ea4fe66a7733d0b76b7bf93ebc4af2f49256ae58101fee92b04</span>
    <span class="p">},</span>
    
    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;Brainpool-p224r1&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">WEIERSTRASS</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">224</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0xD7C134AA264366862A18302575D1D787B09F075797DA89F57EC8C0FF</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mh">0x0D9029AD2C7E5CF4340823B2A87DC68C9E4CE3174C1E6EFDEE12C07D</span><span class="p">,</span>
                      <span class="mh">0x58AA56F772C0726F24C6B89E4ECDAC24354B9E99CAA3F6D3761402CD</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0xD7C134AA264366862A18302575D0FB98D116BC4B6DDEBCA3A5A7939F</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mh">0x1</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mh">0x68A5E62CA9CE6C1C299803A6C1530B514E182AD8B0042A59CAD29F43</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span>         <span class="mh">0x2580F63CCFE44138870713B1A92369E33E2135D266DBB372386C400B</span>
    <span class="p">},</span>
    
    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;Brainpool-p224t1&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">WEIERSTRASS</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">192</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mh">0xD7C134AA264366862A18302575D1D787B09F075797DA89F57EC8C0FC</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span>         <span class="mh">0x4B337D934104CD7BEF271BF60CED1ED20DA14C08B3BB64F18A60888D</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0x2DF271E14427A346910CF7A2E6CFA7B3F484E5C2CCE1C8B730E28B3F</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mh">0x6AB1E344CE25FF3896424E7FFE14762ECB49F8928AC0C76029B4D580</span><span class="p">,</span>
                      <span class="mh">0x0374E9F5143E568CD23F3F4D7C0D4B1E41C8CC0D1C6ABD5F1A46DB4C</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0xD7C134AA264366862A18302575D0FB98D116BC4B6DDEBCA3A5A7939F</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>   <span class="mh">0x1</span><span class="p">,</span>
    <span class="p">},</span>
    
    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;Brainpool-p192r1&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">WEIERSTRASS</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">192</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0xc302f41d932a36cda7a3463093d18db78fce476de1a86297</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mh">0xc0a0647eaab6a48753b033c56cb0f0900a2f5c4853375fd6</span><span class="p">,</span>
                      <span class="mh">0x14b690866abd5bb88b5f4828c1490002e6773fa2fa299b8f</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0xc302f41d932a36cda7a3462f9e9e916b5be8f1029ac4acc1</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mh">0x1</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mh">0x6a91174076b1e0e19c39c031fe8685c1cae040e5c69a28ef</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span>         <span class="mh">0x469a28ef7c28cca3dc721d044f4496bcca7ef4146fbf25c9</span>
    <span class="p">},</span>
    
    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;Brainpool-p192t1&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">WEIERSTRASS</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">192</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0xc302f41d932a36cda7a3463093d18db78fce476de1a86297</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mh">0x3ae9e58c82f63c30282e1fe7bbf43fa72c446af6f4618129</span><span class="p">,</span>
                      <span class="mh">0x97e2c5667c2223a902ab5ca449d0084b7e5b3de7ccc01c9</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0xc302f41d932a36cda7a3462f9e9e916b5be8f1029ac4acc1</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mh">0x1</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mh">0xc302f41d932a36cda7a3463093d18db78fce476de1a86294</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span>         <span class="mh">0x13d56ffaec78681e68f9deb43b35bec2fb68542e27897b79</span>
    <span class="p">},</span>
    
    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;Brainpool-p160r1&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">WEIERSTRASS</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">160</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0xe95e4a5f737059dc60dfc7ad95b3d8139515620f</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mh">0xbed5af16ea3f6a4f62938c4631eb5af7bdbcdbc3</span><span class="p">,</span>
                      <span class="mh">0x1667cb477a1a8ec338f94741669c976316da6321</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0xe95e4a5f737059dc60df5991d45029409e60fc09</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mh">0x1</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mh">0x340e7be2a280eb74e2be61bada745d97e8f7c300</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span>         <span class="mh">0x1e589a8595423412134faa2dbdec95c8d8675e58</span>
    <span class="p">},</span>

    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;Brainpool-p160t1&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">WEIERSTRASS</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">160</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0xe95e4a5f737059dc60dfc7ad95b3d8139515620f</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mh">0xb199b13b9b34efc1397e64baeb05acc265ff2378</span><span class="p">,</span>
                      <span class="mh">0xadd6718b7c7c1961f0991b842443772152c9e0ad</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0xe95e4a5f737059dc60df5991d45029409e60fc09</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mh">0x1</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mh">0xe95e4a5f737059dc60dfc7ad95b3d8139515620c</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span>         <span class="mh">0x7a556b6dae535b7b51ed2c4d7daa7a0b5c55f380</span>
    <span class="p">},</span>

    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;NIST-P256&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">WEIERSTRASS</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">256</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mh">0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296</span><span class="p">,</span>
                      <span class="mh">0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mh">0x1</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mh">0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span>         <span class="mh">0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b</span>
    <span class="p">},</span>

    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;NIST-P224&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">WEIERSTRASS</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">224</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mh">0xB70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21</span> <span class="p">,</span>
                      <span class="mh">0xBD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0xFFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mh">0x1</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mh">0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span>         <span class="mh">0xB4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4</span>
    <span class="p">},</span>
    
    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;NIST-P192&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">WEIERSTRASS</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">192</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0xfffffffffffffffffffffffffffffffeffffffffffffffff</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mh">0x188da80eb03090f67cbf20eb43a18800f4ff0afd82ff1012</span><span class="p">,</span>
                      <span class="mh">0x07192b95ffc8da78631011ed6b24cdd573f977a11e794811</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0xffffffffffffffffffffffff99def836146bc9b1b4d22831</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mh">0x1</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mh">0xfffffffffffffffffffffffffffffffefffffffffffffffc</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span>         <span class="mh">0x64210519e59c80e70fa7e9ab72243049feb8deecc146b9b1</span>
    <span class="p">},</span>

    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;Ed448&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">TWISTEDEDWARD</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">448</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffff</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mh">0x4f1970c66bed0ded221d15a622bf36da9e146570470f1767ea6de324a3d3a46412ae1af72ab66511433b80e18b00938e2626a82bc70cc05e</span><span class="p">,</span>
                      <span class="mh">0x693f46716eb6bc248876203756c9c7624bea73736ca3984087789c1e05a0c2d73ad3ff1ce67c39c4fdbd132c4ed7c8ad9808795bf230fa14</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0x3fffffffffffffffffffffffffffffffffffffffffffffffffffffff7cca23e9c44edb49aed63690216cc2728dc58f552378c292ab5844f3</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mi">4</span><span class="p">,</span>
        <span class="s1">&#39;d&#39;</span><span class="p">:</span>         <span class="mh">0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffff6756</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mi">1</span>
    <span class="p">},</span>

    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;Ed25519&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">TWISTEDEDWARD</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">256</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">15112221349535400772501151409588531511454012693041857206046113283949847762202</span><span class="p">,</span>
                      <span class="mi">46316835694926478169428394003475163141307993866256225615783033603165251855960</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0x1000000000000000000000000000000014DEF9DEA2F79CD65812631A5CF5D3ED</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mh">0x08</span><span class="p">,</span>
        <span class="s1">&#39;d&#39;</span><span class="p">:</span>         <span class="mh">0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="o">-</span><span class="mi">1</span>
    <span class="p">},</span>
 
    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;Curve448&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">MONTGOMERY</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">448</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffff</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span>
                      <span class="mh">0x7d235d1295f5b1f66c98ab6e58326fcecbae5d34f55545d060f75dc28df3f6edb8027e2346430d211312c4b150677af76fd7223d457b5b1a</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0x3fffffffffffffffffffffffffffffffffffffffffffffffffffffff7cca23e9c44edb49aed63690216cc2728dc58f552378c292ab5844f3</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mi">4</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span>         <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mh">0x262a6</span>
    <span class="p">},</span>

    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>      <span class="s2">&quot;Curve25519&quot;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="n">MONTGOMERY</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span>      <span class="mi">256</span><span class="p">,</span>
        <span class="s1">&#39;field&#39;</span><span class="p">:</span>     <span class="mh">0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed</span><span class="p">,</span>
        <span class="s1">&#39;generator&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span>
                      <span class="mi">43114425171068552920764898935933967039370386198203806730763910166200978582548</span><span class="p">),</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span>     <span class="mh">0x1000000000000000000000000000000014DEF9DEA2F79CD65812631A5CF5D3ED</span><span class="p">,</span>
        <span class="s1">&#39;cofactor&#39;</span><span class="p">:</span>  <span class="mh">0x08</span><span class="p">,</span>
        <span class="s1">&#39;b&#39;</span><span class="p">:</span>         <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;a&#39;</span><span class="p">:</span>         <span class="mi">486662</span>
    <span class="p">},</span>
<span class="p">]</span>



<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1">###############################</span>
        <span class="c1">### Weierstrass quick check ###</span>
        <span class="c1">###############################</span>
        <span class="n">cv</span>  <span class="o">=</span> <span class="n">Curve</span><span class="o">.</span><span class="n">get_curve</span><span class="p">(</span><span class="s1">&#39;secp256k1&#39;</span><span class="p">)</span>
        
        <span class="c1">#check generator</span>
        <span class="n">Gx</span> <span class="o">=</span> <span class="mh">0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798</span>
        <span class="n">Gy</span> <span class="o">=</span> <span class="mh">0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8</span>
        <span class="n">G</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">Gx</span><span class="p">,</span> <span class="n">Gy</span><span class="p">,</span> <span class="n">cv</span><span class="p">)</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">G</span> <span class="o">==</span> <span class="n">cv</span><span class="o">.</span><span class="n">generator</span><span class="p">)</span>

        <span class="c1">#define point    </span>
        <span class="n">W1</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mh">0x6fb13b7e8ab1c7d191d16197c1bf7f8dc7992412e1266155b3fb3ac8b30f3ed8</span><span class="p">,</span>
                   <span class="mh">0x2e1eb77bd89505113819600b395e0475d102c4788a3280a583d9d82625ed8533</span><span class="p">,</span>
                   <span class="n">cv</span><span class="p">)</span>
        <span class="n">W2</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mh">0x07cd9ee748a0b26773d9d29361f75594964106d13e1cad67cfe2df503ee3e90e</span><span class="p">,</span>
                   <span class="mh">0xd209f7c16cdb6d3559bea88c7d920f8ff077406c615da8adfecdeef604cb40a6</span><span class="p">,</span>
                   <span class="n">cv</span><span class="p">)</span>
        
        <span class="c1">#check add</span>
        <span class="n">sum_W1_W2</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mh">0xc4a20cbc2dc27c70fbc1335292c109a1ccd106981b5698feafe702bcb0fb2fca</span><span class="p">,</span>
                          <span class="mh">0x7e1ad514051b87b7ce815c7defcd4fcc01e88842b3135e10a342be49bf5cad09</span><span class="p">,</span>
                          <span class="n">cv</span><span class="p">)</span>
        <span class="n">dbl_W2</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mh">0xb4f211b11166e6b3a3561e5978f47855787943dbeccd2014706c941a5890c913</span><span class="p">,</span>
                       <span class="mh">0xe0122dc6f3ce097eb73865e66a1ced02a518afdec02596d7d152f121391e2d63</span><span class="p">,</span>
                       <span class="n">cv</span><span class="p">)</span>
        
        <span class="n">s</span> <span class="o">=</span> <span class="n">W1</span><span class="o">+</span><span class="n">W2</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">s</span> <span class="o">==</span> <span class="n">sum_W1_W2</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">W2</span><span class="o">+</span><span class="n">W2</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">d</span> <span class="o">==</span> <span class="n">dbl_W2</span><span class="p">)</span>
        
        <span class="c1">#check mul</span>
        <span class="n">k</span> <span class="o">=</span> <span class="mh">0x2976F786AE6333E125C0DFFD6C16D37E8CED5ABEDB491BCCA21C75B307D0B318</span>
        <span class="n">kW1</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mh">0x1de93c28f8c58db95f30be1704394f6f5d4602291c4933a1126cc61f9ed70b88</span><span class="p">,</span>
                    <span class="mh">0x6f66df7bb6b37609cacded3052e1d127b47684949dff366020f824d517d66f34</span><span class="p">,</span>
                    <span class="n">cv</span><span class="p">)</span>
        <span class="n">mulW1</span> <span class="o">=</span> <span class="n">k</span><span class="o">*</span><span class="n">W1</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">kW1</span> <span class="o">==</span> <span class="n">mulW1</span><span class="p">)</span>

        <span class="c1">#check encoding</span>
        <span class="n">W2_enc</span> <span class="o">=</span> <span class="p">[</span> <span class="mh">0x04</span><span class="p">,</span>
                   <span class="c1">#x</span>
                   <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0xcd</span><span class="p">,</span> <span class="mh">0x9e</span><span class="p">,</span> <span class="mh">0xe7</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0xa0</span><span class="p">,</span> <span class="mh">0xb2</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> <span class="mh">0xd9</span><span class="p">,</span> <span class="mh">0xd2</span><span class="p">,</span> <span class="mh">0x93</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span> <span class="mh">0xf7</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x94</span><span class="p">,</span>
                   <span class="mh">0x96</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0xd1</span><span class="p">,</span> <span class="mh">0x3e</span><span class="p">,</span> <span class="mh">0x1c</span><span class="p">,</span> <span class="mh">0xad</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0xcf</span><span class="p">,</span> <span class="mh">0xe2</span><span class="p">,</span> <span class="mh">0xdf</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x3e</span><span class="p">,</span> <span class="mh">0xe3</span><span class="p">,</span> <span class="mh">0xe9</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span>
                <span class="c1">#y</span>
                   <span class="mh">0xd2</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">,</span> <span class="mh">0xf7</span><span class="p">,</span> <span class="mh">0xc1</span><span class="p">,</span> <span class="mh">0x6c</span><span class="p">,</span> <span class="mh">0xdb</span><span class="p">,</span> <span class="mh">0x6d</span><span class="p">,</span> <span class="mh">0x35</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0xbe</span><span class="p">,</span> <span class="mh">0xa8</span><span class="p">,</span> <span class="mh">0x8c</span><span class="p">,</span> <span class="mh">0x7d</span><span class="p">,</span> <span class="mh">0x92</span><span class="p">,</span> <span class="mh">0x0f</span><span class="p">,</span> <span class="mh">0x8f</span><span class="p">,</span>
                   <span class="mh">0xf0</span><span class="p">,</span> <span class="mh">0x77</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x6c</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span> <span class="mh">0x5d</span><span class="p">,</span> <span class="mh">0xa8</span><span class="p">,</span> <span class="mh">0xad</span><span class="p">,</span> <span class="mh">0xfe</span><span class="p">,</span> <span class="mh">0xcd</span><span class="p">,</span> <span class="mh">0xee</span><span class="p">,</span> <span class="mh">0xf6</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0xcb</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0xa6</span><span class="p">]</span>
        <span class="n">dW2_enc</span> <span class="o">=</span> <span class="p">[</span> <span class="mh">0x04</span><span class="p">,</span>
                    <span class="c1">#x</span>
                    <span class="mh">0xb4</span><span class="p">,</span> <span class="mh">0xf2</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0xb1</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0xe6</span><span class="p">,</span> <span class="mh">0xb3</span><span class="p">,</span> <span class="mh">0xa3</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span> <span class="mh">0x1e</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0x78</span><span class="p">,</span> <span class="mh">0xf4</span><span class="p">,</span> <span class="mh">0x78</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span>
                    <span class="mh">0x78</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0x43</span><span class="p">,</span> <span class="mh">0xdb</span><span class="p">,</span> <span class="mh">0xec</span><span class="p">,</span> <span class="mh">0xcd</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x70</span><span class="p">,</span> <span class="mh">0x6c</span><span class="p">,</span> <span class="mh">0x94</span><span class="p">,</span> <span class="mh">0x1a</span><span class="p">,</span> <span class="mh">0x58</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0xc9</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span>
                    <span class="c1">#y</span>
                    <span class="mh">0xe0</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x2d</span><span class="p">,</span> <span class="mh">0xc6</span><span class="p">,</span> <span class="mh">0xf3</span><span class="p">,</span> <span class="mh">0xce</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x7e</span><span class="p">,</span> <span class="mh">0xb7</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0xe6</span><span class="p">,</span> <span class="mh">0x6a</span><span class="p">,</span> <span class="mh">0x1c</span><span class="p">,</span> <span class="mh">0xed</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span>
                <span class="mh">0xa5</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">,</span> <span class="mh">0xaf</span><span class="p">,</span> <span class="mh">0xde</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">,</span> <span class="mh">0x96</span><span class="p">,</span> <span class="mh">0xd7</span><span class="p">,</span> <span class="mh">0xd1</span><span class="p">,</span> <span class="mh">0x52</span><span class="p">,</span> <span class="mh">0xf1</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mh">0x39</span><span class="p">,</span> <span class="mh">0x1e</span><span class="p">,</span> <span class="mh">0x2d</span><span class="p">,</span> <span class="mh">0x63</span><span class="p">]</span>
        <span class="n">W2_enc_comp</span> <span class="o">=</span> <span class="p">[</span> <span class="mh">0x02</span><span class="p">,</span>
                        <span class="c1">#x</span>
                        <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0xcd</span><span class="p">,</span> <span class="mh">0x9e</span><span class="p">,</span> <span class="mh">0xe7</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0xa0</span><span class="p">,</span> <span class="mh">0xb2</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> <span class="mh">0xd9</span><span class="p">,</span> <span class="mh">0xd2</span><span class="p">,</span> <span class="mh">0x93</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span> <span class="mh">0xf7</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x94</span><span class="p">,</span>
                        <span class="mh">0x96</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0xd1</span><span class="p">,</span> <span class="mh">0x3e</span><span class="p">,</span> <span class="mh">0x1c</span><span class="p">,</span> <span class="mh">0xad</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0xcf</span><span class="p">,</span> <span class="mh">0xe2</span><span class="p">,</span> <span class="mh">0xdf</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x3e</span><span class="p">,</span> <span class="mh">0xe3</span><span class="p">,</span> <span class="mh">0xe9</span><span class="p">,</span> <span class="mh">0x0e</span><span class="p">,</span>
                        <span class="c1">#y sign</span>
                        <span class="mi">0</span><span class="p">]</span>
        <span class="n">dW2_enc_comp</span> <span class="o">=</span> <span class="p">[</span> <span class="mh">0x02</span><span class="p">,</span>
                        <span class="c1">#x</span>
                         <span class="mh">0xb4</span><span class="p">,</span> <span class="mh">0xf2</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0xb1</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0xe6</span><span class="p">,</span> <span class="mh">0xb3</span><span class="p">,</span> <span class="mh">0xa3</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span> <span class="mh">0x1e</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0x78</span><span class="p">,</span> <span class="mh">0xf4</span><span class="p">,</span> <span class="mh">0x78</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span>
                         <span class="mh">0x78</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0x43</span><span class="p">,</span> <span class="mh">0xdb</span><span class="p">,</span> <span class="mh">0xec</span><span class="p">,</span> <span class="mh">0xcd</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x70</span><span class="p">,</span> <span class="mh">0x6c</span><span class="p">,</span> <span class="mh">0x94</span><span class="p">,</span> <span class="mh">0x1a</span><span class="p">,</span> <span class="mh">0x58</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0xc9</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span>
                        <span class="c1">#y</span>
                         <span class="mi">1</span><span class="p">]</span>

        <span class="n">P</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">encode_point</span><span class="p">(</span><span class="n">W2</span><span class="p">)</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">P</span> <span class="o">==</span> <span class="n">W2_enc</span><span class="p">)</span>
        <span class="n">P</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">decode_point</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">P</span> <span class="o">==</span> <span class="n">W2</span><span class="p">)</span>
        
        <span class="n">P</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">encode_point</span><span class="p">(</span><span class="n">dbl_W2</span><span class="p">)</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">P</span> <span class="o">==</span> <span class="n">dW2_enc</span><span class="p">)</span>
        <span class="n">P</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">decode_point</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">P</span> <span class="o">==</span> <span class="n">dbl_W2</span><span class="p">)</span>

        <span class="n">P</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">encode_point</span><span class="p">(</span><span class="n">W2</span><span class="p">,</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">P</span> <span class="o">==</span> <span class="n">W2_enc_comp</span><span class="p">)</span>
        <span class="n">P</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">decode_point</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">P</span> <span class="o">==</span> <span class="n">W2</span><span class="p">)</span>

        <span class="n">P</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">encode_point</span><span class="p">(</span><span class="n">dbl_W2</span><span class="p">,</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">P</span> <span class="o">==</span> <span class="n">dW2_enc_comp</span><span class="p">)</span>
        <span class="n">P</span> <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">decode_point</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">P</span> <span class="o">==</span> <span class="n">dbl_W2</span><span class="p">)</span>
        
        
        <span class="c1">##################################</span>
        <span class="c1">### Twisted Edward quick check ###</span>
        <span class="c1">##################################</span>
        <span class="n">cv</span>  <span class="o">=</span> <span class="n">Curve</span><span class="o">.</span><span class="n">get_curve</span><span class="p">(</span><span class="s1">&#39;Ed25519&#39;</span><span class="p">)</span>
        
        <span class="n">W1</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mh">0x36ab384c9f5a046c3d043b7d1833e7ac080d8e4515d7a45f83c5a14e2843ce0e</span><span class="p">,</span>
                   <span class="mh">0x2260cdf3092329c21da25ee8c9a21f5697390f51643851560e5f46ae6af8a3c9</span><span class="p">,</span>
                   <span class="n">cv</span><span class="p">)</span>
        <span class="n">W2</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mh">0x67ae9c4a22928f491ff4ae743edac83a6343981981624886ac62485fd3f8e25c</span><span class="p">,</span>
                   <span class="mh">0x1267b1d177ee69aba126a18e60269ef79f16ec176724030402c3684878f5b4d4</span><span class="p">,</span>
                   <span class="n">cv</span><span class="p">)</span>
        
        <span class="c1">#check generator</span>
        <span class="n">Bx</span> <span class="o">=</span> <span class="mi">15112221349535400772501151409588531511454012693041857206046113283949847762202</span>
        <span class="n">By</span> <span class="o">=</span> <span class="mi">46316835694926478169428394003475163141307993866256225615783033603165251855960</span> 
        <span class="n">B</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">Bx</span><span class="p">,</span> <span class="n">By</span><span class="p">,</span> <span class="n">cv</span><span class="p">)</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">B</span> <span class="o">==</span> <span class="n">cv</span><span class="o">.</span><span class="n">generator</span><span class="p">)</span>
        
        <span class="c1">#check add</span>
        <span class="n">sum_W1_W2</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mh">0x49fda73eade3587bfcef7cf7d12da5de5c2819f93e1be1a591409cc0322ef233</span><span class="p">,</span>
                          <span class="mh">0x5f4825b298feae6fe02c6e148992466631282eca89430b5d10d21f83d676c8ed</span><span class="p">,</span>
                          
                          <span class="n">cv</span><span class="p">)</span>
        <span class="n">dbl_W1</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mh">0x203da8db56cff1468325d4b87a3520f91a739ec193ce1547493aa657c4c9f870</span><span class="p">,</span>
                       <span class="mh">0x47d0e827cb1595e1470eb88580d5716c4cf22832ea2f0ff0df38ab61ca32112f</span><span class="p">,</span>
                       <span class="n">cv</span><span class="p">)</span>
        
        <span class="n">s</span> <span class="o">=</span> <span class="n">W1</span><span class="o">+</span><span class="n">W2</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">s</span> <span class="o">==</span> <span class="n">sum_W1_W2</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">W1</span><span class="o">+</span><span class="n">W1</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">d</span> <span class="o">==</span> <span class="n">dbl_W1</span><span class="p">)</span>
        
        <span class="c1">#check mul</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mh">0x74ad28205b4f384bc0813e6585864e528085f91fb6a5096f244ae01e57de43ae</span><span class="p">,</span>
                  <span class="mh">0x0c66f42af155cdc08c96c42ecf2c989cbc7e1b4da70ab7925a8943e8c317403d</span><span class="p">,</span>
                  <span class="n">cv</span><span class="p">)</span>
        <span class="n">k</span>  <span class="o">=</span> <span class="mh">0x035ce307f6524510110b4ea1c8af0e81fb705118ebcf886912f8d2d87b5776b3</span>
        <span class="n">kA</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mh">0x0d968dd46de0ff98f4a6916e60f84c8068444dbc2d93f5d3b9cf06dade04a994</span><span class="p">,</span>
                   <span class="mh">0x3ba16a015e1dd42b3d088c7a68c344ec47aaba463f67f4e9099c634f64781e00</span><span class="p">,</span>
                   <span class="n">cv</span><span class="p">)</span>
        <span class="n">mul</span> <span class="o">=</span> <span class="n">k</span><span class="o">*</span><span class="n">A</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">mul</span> <span class="o">==</span> <span class="n">kA</span><span class="p">)</span>
        

        <span class="c1">##################################</span>
        <span class="c1">### Montgomery quick check ###</span>
        <span class="c1">##################################</span>
        <span class="n">cv</span>     <span class="o">=</span> <span class="n">Curve</span><span class="o">.</span><span class="n">get_curve</span><span class="p">(</span><span class="s1">&#39;Curve25519&#39;</span><span class="p">)</span>

        <span class="c1">#0x449a44ba44226a50185afcc10a4c1462dd5e46824b15163b9d7c52f06be346a0</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">binascii</span><span class="o">.</span><span class="n">unhexlify</span><span class="p">(</span><span class="s2">&quot;a546e36bf0527c9d3b16154b82465edd62144c0ac1fc5a18506a2244ba449ac4&quot;</span><span class="p">)</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">decode_scalar_25519</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">k</span> <span class="o">==</span> <span class="mi">31029842492115040904895560451863089656472772604678260265531221036453811406496</span><span class="p">)</span>
        
        <span class="n">eP</span> <span class="o">=</span>  <span class="n">binascii</span><span class="o">.</span><span class="n">unhexlify</span><span class="p">(</span><span class="s2">&quot;e6db6867583030db3594c1a424b15f7c726624ec26b3353b10a903a6d0ab1c4c&quot;</span><span class="p">)</span>
        <span class="n">P</span>  <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">decode_point</span><span class="p">(</span><span class="n">eP</span><span class="p">)</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="mi">34426434033919594451155107781188821651316167215306631574996226621102155684838</span><span class="p">)</span>

        <span class="n">eQ</span> <span class="o">=</span> <span class="n">binascii</span><span class="o">.</span><span class="n">unhexlify</span><span class="p">(</span><span class="s2">&quot;c3da55379de9c6908e94ea4df28d084f32eccf03491c71f754b4075577a28552&quot;</span><span class="p">)</span>
        <span class="n">Q</span>  <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">decode_point</span><span class="p">(</span><span class="n">eQ</span><span class="p">)</span>
        
        <span class="n">kP</span> <span class="o">=</span> <span class="n">k</span><span class="o">*</span><span class="n">P</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">kP</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="n">Q</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
        <span class="n">ekP</span> <span class="o">=</span>  <span class="n">cv</span><span class="o">.</span><span class="n">encode_point</span><span class="p">(</span><span class="n">kP</span><span class="p">)</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">ekP</span> <span class="o">==</span> <span class="n">eQ</span><span class="p">)</span>


        <span class="c1">#0x4dba18799e16a42cd401eae021641bc1f56a7d959126d25a3c67b4d1d4e96648</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">binascii</span><span class="o">.</span><span class="n">unhexlify</span><span class="p">(</span><span class="s2">&quot;4b66e9d4d1b4673c5ad22691957d6af5c11b6421e0ea01d42ca4169e7918ba0d&quot;</span><span class="p">)</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">decode_scalar_25519</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">k</span> <span class="o">==</span> <span class="mi">35156891815674817266734212754503633747128614016119564763269015315466259359304</span><span class="p">)</span>
        
        <span class="n">eP</span> <span class="o">=</span>  <span class="n">binascii</span><span class="o">.</span><span class="n">unhexlify</span><span class="p">(</span><span class="s2">&quot;e5210f12786811d3f4b7959d0538ae2c31dbe7106fc03c3efc4cd549c715a493&quot;</span><span class="p">)</span>
        <span class="n">P</span>  <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">decode_point</span><span class="p">(</span><span class="n">eP</span><span class="p">)</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="mi">8883857351183929894090759386610649319417338800022198945255395922347792736741</span><span class="p">)</span>

        <span class="n">eQ</span> <span class="o">=</span> <span class="n">binascii</span><span class="o">.</span><span class="n">unhexlify</span><span class="p">(</span><span class="s2">&quot;95cbde9476e8907d7aade45cb4b873f88b595a68799fa152e6f8f7647aac7957&quot;</span><span class="p">)</span>
        <span class="n">Q</span>  <span class="o">=</span> <span class="n">cv</span><span class="o">.</span><span class="n">decode_point</span><span class="p">(</span><span class="n">eQ</span><span class="p">)</span>
        
        <span class="n">kP</span> <span class="o">=</span> <span class="n">k</span><span class="o">*</span><span class="n">P</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">kP</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="n">Q</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
        <span class="n">ekP</span> <span class="o">=</span>  <span class="n">cv</span><span class="o">.</span><span class="n">encode_point</span><span class="p">(</span><span class="n">kP</span><span class="p">)</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">ekP</span> <span class="o">==</span> <span class="n">eQ</span><span class="p">)</span>




        <span class="c1">##OK!</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;All internal assert OK!&quot;</span><span class="p">)</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="k">pass</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Cédric Mesnil.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    

    
  </body>
</html>